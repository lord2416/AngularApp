angular.module("myApp",["ngRoute","angularTrix","angularify.semantic.dropdown","ui.tinymce","myApp.common","myApp.main","myApp.user"]).config(["$routeProvider","$locationProvider","$httpProvider",function(e,t,r){r.defaults.headers.get||(r.defaults.headers.get={}),r.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",r.defaults.headers.get["Cache-Control"]="no-cache",r.defaults.headers.get.Pragma="no-cache",e.when("/",{templateUrl:"template/testNgRoute-main.html",controller:"mainCtrl",resolve:{mainData:["testService",function(e){return e.getMain().then(function(e){return e.data}).catch(function(e){return e.data})}]}}).when("/user/:userId",{templateUrl:"template/testNgRoute-user.html",controller:"userCtrl",resolve:{userData:["testService",function(e){return e.getUser().then(function(e){return e.data})}]},reloadOnSearch:!1}).when("/tinymice",{templateUrl:"template/tinymice.html",controller:"tinymiceCtrl",reloadOnSearch:!1}).when("/dropdown",{templateUrl:"template/dropdown.html",controller:"TestDropDownCtrl",reloadOnSearch:!1}).otherwise({redirectTo:"/"}),t.html5Mode(!1),t.hashPrefix(""),r.interceptors.push("httpInterceptor"),console.log("the angular app is start!")}]).run(["$rootScope","$templateCache",function(e,t){e.loading=!1,e.$on("$routeChangeStart",function(e,r,o){void 0!==o&&t.remove(o.templateUrl)}),e.$on("$routeUpdate",function(e,t,r){console.log(e),console.log(t),console.log(r)})}]),angular.element(document).ready(function(){angular.bootstrap(document,["myApp"])});
angular.module("myApp.common",[]),angular.module("myApp.main",["myApp.main.tinymice","myApp.main.dropdown"]),angular.module("myApp.main.tinymice",["myApp.common","ui.tinymce"]),angular.module("myApp.main.dropdown",["myApp.common","angularify.semantic.dropdown"]),angular.module("myApp.user",["myApp.common"]);
angular.module("ui.tinymce",[]).value("uiTinymceConfig",{}).directive("uiTinymce",["$rootScope","$compile","$timeout","$window","$sce","uiTinymceConfig","uiTinymceService",function(e,t,n,i,r,o,u){return o=o||{},o.baseUrl&&(tinymce.baseURL=o.baseUrl),{require:["ngModel","^?form"],priority:599,link:function(c,a,s,d){function f(e){e?(m(),v&&v.getBody().setAttribute("contenteditable",!1)):(m(),v&&!v.settings.readonly&&v.getDoc()&&v.getBody().setAttribute("contenteditable",!0))}function m(){v||(v=tinymce.get(s.id))}if(i.tinymce){var l,v,$=d[0],g=d[1]||null,y={debounce:!0},b=function(t){var n=t.getContent({format:y.format}).trim();n=r.trustAsHtml(n),$.$setViewValue(n),e.$$phase||c.$digest()},p=u.getUniqueId();s.$set("id",p),l={},angular.extend(l,c.$eval(s.uiTinymce));var h=function(e){var t;return function(e){n.cancel(t),t=n(function(){return function(e){e.isDirty()&&(e.save(),b(e))}(e)},400)}}(),U={setup:function(t){t.on("init",function(){$.$render(),$.$setPristine(),$.$setUntouched(),g&&g.$setPristine()}),t.on("ExecCommand change NodeChange ObjectResized",function(){if(!y.debounce)return t.save(),void b(t);h(t)}),t.on("blur",function(){a[0].blur(),$.$setTouched(),e.$$phase||c.$digest()}),t.on("remove",function(){a.remove()}),o.setup&&o.setup(t,{updateView:b}),l.setup&&l.setup(t,{updateView:b})},format:l.format||"html",selector:"#"+s.id};angular.extend(y,o,l,U),n(function(){y.baseURL&&(tinymce.baseURL=y.baseURL);var e=tinymce.init(y);e&&"function"==typeof e.then?e.then(function(){f(c.$eval(s.ngDisabled))}):f(c.$eval(s.ngDisabled))}),$.$formatters.unshift(function(e){return e?r.trustAsHtml(e):""}),$.$parsers.unshift(function(e){return e?r.getTrustedHtml(e):""}),$.$render=function(){m();var e=$.$viewValue?r.getTrustedHtml($.$viewValue):"";v&&v.getDoc()&&(v.setContent(e),v.fire("change"))},s.$observe("disabled",f);var T=c.$on("$tinymce:refresh",function(e,n){var i=s.id;if(angular.isUndefined(n)||n===i){var r=a.parent(),o=a.clone();o.removeAttr("id"),o.removeAttr("style"),o.removeAttr("aria-hidden"),tinymce.execCommand("mceRemoveEditor",!1,i),r.append(t(o)(c)),T()}});c.$on("$destroy",function(){m(),v&&(v.remove(),v=null)})}}}}]).service("uiTinymceService",[function(){return new function(){var e=0;return{getUniqueId:function(){return"ui-tinymce-"+ ++e}}}}]);
angular.module("myApp.common").directive("myInputParse",function(){return{restrict:"EA",priority:-1,require:"?ngModel",link:function(e,t,n,i){i&&(console.log("myInputParse"),i.$parsers.push(function(e){var t=/^\d+\.?\d{0,2}$/,n=t.test(e),r=e.substring(0,e.length-1);return n?e:(i.$setViewValue(r),i.$render(),r)}))}}}).directive("companyEmailValidator",function(){var e=/^(?=.{1,254}$)(?=.{1,254}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/;return{restrict:"EA",priority:-1,require:"?ngModel",link:function(t,n,i,r){r&&r.$validators.email&&(r.$validators.email=function(t,n){var i=t||n;return r.$isEmpty(i)||e.test(i)})}}}).directive("retainDecimal",function(){var e=/^\d+$/,t=/^\d+(\.)?\d{0,1}$/,n=/^\d+(\.)?\d{0,2}$/;return{restrict:"A",require:"?ngModel",link:function(i,r,a,o){o.$parsers.push(function(i){var r,d,s=a.retainDecimal,l=i.substring(0,i.length-1),c=i.charAt(i.length-1);switch(s){case"1":r=t.test(i),d=".0";break;case"2":r=n.test(i),d=".00";break;default:r=e.test(i),d=""}return r?"."==c?(o.$setViewValue(l+d),o.$render(),l+d):i:(o.$setViewValue(l),o.$render(),l)})}}}).directive("searchSelect",["$sce",function(e){return{restrict:"EA",replace:!0,transclude:!0,require:"?ngModel",scope:{options:"=",name:"@"},template:'<div class="ui fluid search selection dropdown upward">\t\t\t\t<input type="hidden" name="{{name}}" ng-model="selectedValue">\t\t\t\t<i class="dropdown icon"></i>\t\t\t\t<div class="default text" ng-bind="selectedValue"></div>\t\t\t  \t<div class="menu transition hidden">\t\t\t    \t<div class="item" data-index="{{option.index}}" data-value="{{option.index}}" ng-repeat = "option in options" ng-bind="option.item"></div>\t\t\t  \t</div>\t\t\t</div>',link:function(e,t,n,i){t.dropdown({fullTextSearch:!0,onChange:function(t,n,r){e.$apply(function(){i.$setViewValue(t)})}}),i.$render=function(){console.log("it is $render"),t.dropdown("set selected","3")},n.$observe("ngModel",function(e){console.log(e)})}}}]);
angular.module("myApp.common").factory("httpInterceptor",["$sce","$rootScope","$timeout",function(n,e,t){var o,r;return{request:function(n){return o=(new Date).getTime(),e.loading=!0,n},response:function(n){return r=(new Date).getTime(),e.$evalAsync(function(){r-o>500?e.loading=!1:t(function(){e.loading=!1},500)}),n}}}]);
angular.module("myApp.common").factory("testService",["$http","$q",function(t,e){return{getMain:function(){return t.get("mock/testNgRoute-main.json")},getUser:function(){return t.get("mock/testNgRoute-user.json")},getRest:function(){return t.get("/restapi/login")}}}]);
angular.module("myApp.main.dropdown").controller("TestDropDownCtrl",["$scope","$route","$routeParams","$location","$sce",function(o,e,t,m,i){o.dropdown_model="item3",o.dropdown_repeat_model="item1",o.dropdown_items=["item1","item2","item3","item4"],o.dropdown_key_value_model="",o.dropdown_key_value_items={item1:"Cool item 1",item2:"Cool item 2",item3:"Cool item 3",item4:"Cool item 4"}}]);
angular.module("myApp.main").controller("mainCtrl",["$scope","$route","$routeParams","$location","mainData","$parse",function(e,t,i,n,s,a){e.pageName=s.pageName,e.myInputVal1="111",e.myInputVal2="",e.myInputVal3="",e.myInputVal4="",e.selectVal="",e.parentOptions=[{item:"Arabic Chinese",select:!0,index:1},{item:"Chinese ",select:!1,index:2},{item:"Dutch",select:!1,index:3},{item:"English",select:!1,index:4},{item:"French",select:!1,index:5},{item:"German",select:!1,index:6},{item:"Greek",select:!1,index:7},{item:"Hungarian",select:!1,index:8},{item:"Italian",select:!1,index:9},{item:"Japanese",select:!1,index:10},{item:"Korean",select:!1,index:11},{item:"Lithuanian",select:!1,index:12},{item:"Persian",select:!1,index:13},{item:"Polish",select:!1,index:14},{item:"Portuguese",select:!1,index:15},{item:"Russian",select:!1,index:16},{item:"Spanish",select:!1,index:17},{item:"Swedish",select:!1,index:18},{item:"Turkish",select:!1,index:19},{item:"Vietnamese",select:!1,index:20}],e.updateVal=function(){var t=a("'it is my test!the result is:' + myInputVal1");e.myInputValRes=t(e)}}]);
angular.module("myApp.main.tinymice").controller("tinymiceCtrl",["$scope","$route","$routeParams","$location","$sce",function(t,i,e,n,a){var l=this;t.setting={inline:!1,plugins:"advlist autolink lists link image charmap print preview anchor",readonly:"view"===t.operate,skin:"lightgray",theme:"modern",min_height:200,max_height:500},this.updateHtml=function(){l.tinymceHtml=a.trustAsHtml(l.tinymce)}}]);
angular.module("myApp.user").controller("userCtrl",["$scope","$route","$routeParams","$location","userData",function(e,o,t,s,a){e.pageName=a.pageName,e.userId=t.userId,e.foo="please input!";var l=this;console.log(this),console.log(l),this.update=function(){console.log("this update")},this.delete=function(){console.log("this update")}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIm1vZHVsZS5qcyIsImRpcmVjdGl2ZS9hbmd1bGFyLXRpbnltY2UuanMiLCJkaXJlY3RpdmUvaW5wdXREaXJlLmpzIiwic2VydmljZS9pbnRlckNlcHRvclNlcnYuanMiLCJzZXJ2aWNlL3Rlc3RTZXJ2LmpzIiwiY29udHJvbGxlci9tYWluL2Ryb3Bkb3duQ3RybC5qcyIsImNvbnRyb2xsZXIvbWFpbi9tYWluQ3RybC5qcyIsImNvbnRyb2xsZXIvbWFpbi90aW55bWljZUN0cmwuanMiLCJjb250cm9sbGVyL3VzZXIvdXNlckN0cmwuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRodHRwUHJvdmlkZXIiLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJnZXQiLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJyZXNvbHZlIiwibWFpbkRhdGEiLCJ0ZXN0U2VydmljZSIsImdldE1haW4iLCJ0aGVuIiwicmVzIiwidXNlckRhdGEiLCJnZXRVc2VyIiwiZGF0YSIsInJlbG9hZE9uU2VhcmNoIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsIiRsb2NhdGlvblByb3ZpZGVyIiwiaHRtbDVNb2RlIiwiaW50ZXJjZXB0b3JzIiwicHVzaCIsIiRyb290U2NvcGUiLCIkb24iLCJldmVudCIsIm5leHQiLCJjdXJyZW50IiwibG9nIiwiZWxlbWVudCIsImRvY3VtZW50IiwicmVhZHkiLCJib290c3RyYXAiLCJ2YWx1ZSIsImRpcmVjdGl2ZSIsInVpVGlueW1jZUNvbmZpZyIsImJhc2VVcmwiLCJ0aW55bWNlIiwiYmFzZVVSTCIsImRpc2FibGVkIiwiZW5zdXJlSW5zdGFuY2UiLCJ0aW55SW5zdGFuY2UiLCJzZXR0aW5ncyIsInJlYWRvbmx5IiwiZ2V0RG9jIiwiZ2V0Qm9keSIsInNldEF0dHJpYnV0ZSIsIiR3aW5kb3ciLCJleHByZXNzaW9uIiwibmdNb2RlbCIsImN0cmxzIiwiZm9ybSIsIm9wdGlvbnMiLCJkZWJvdW5jZSIsInVwZGF0ZVZpZXciLCJlZGl0b3IiLCJjb250ZW50IiwiZ2V0Q29udGVudCIsImZvcm1hdCIsInRyaW0iLCIkc2V0Vmlld1ZhbHVlIiwiJCRwaGFzZSIsInNjb3BlIiwiJGRpZ2VzdCIsImRlYm91bmNlZFVwZGF0ZSIsImRlYm91bmNlZFVwZGF0ZURlbGF5IiwiZWQiLCJkZWJvdW5jZWRVcGRhdGVUaW1lciIsIiR0aW1lb3V0Iiwic2F2ZSIsIiRyZW5kZXIiLCIkc2V0UHJpc3RpbmUiLCJvbiIsInNldHVwIiwibWF5YmVJbml0UHJvbWlzZSIsImluaXQiLCJ0b2dnbGVEaXNhYmxlIiwiJGV2YWwiLCJhdHRycyIsIm5nRGlzYWJsZWQiLCJ2aWV3VmFsdWUiLCIkdmlld1ZhbHVlIiwiJHNjZSIsImdldFRydXN0ZWRIdG1sIiwic2V0Q29udGVudCIsImZpcmUiLCJpc1VuZGVmaW5lZCIsImlkIiwiZWlkIiwicGFyZW50RWxlbWVudCIsInBhcmVudCIsImNsb25lZEVsZW1lbnQiLCJyZW1vdmVBdHRyIiwiYXBwZW5kIiwiJGNvbXBpbGUiLCJ1bmJpbmRFdmVudExpc3RlbmVyIiwicmVtb3ZlIiwiZ2V0VW5pcXVlSWQiLCJJRF9BVFRSIiwicmVzdHJpY3QiLCJwcmlvcml0eSIsInJlcXVpcmUiLCJsaW5rIiwiJHNjb3BlIiwiJGVsZW0iLCIkYXR0cnMiLCJuZ01vZGVsQ3RybCIsImNvbnNvbGUiLCIkcGFyc2VycyIsIlZBTElEX1JFR0VYUCIsImlzVmFsaWQiLCJ0ZXN0IiwibGFzdFZhbCIsInN1YnN0cmluZyIsImxlbmd0aCIsIiR2YWxpZGF0b3JzIiwiZW1haWwiLCJtb2RlbFZhbHVlIiwiJGlzRW1wdHkiLCJFTUFJTF9SRUdFWFAiLCJzdHIiLCJyZXRhaW5EZWNpbWFsIiwibGFzdENoYXIiLCJjaGFyQXQiLCJST1VORFVQXzFfUkVHRVhQIiwiUk9VTkRVUF8yX1JFR0VYUCIsIlJPVU5EVVBfMF9SRUdFWFAiLCJyZXBsYWNlIiwibmFtZSIsInRlbXBsYXRlIiwiZHJvcGRvd24iLCJmdWxsVGV4dFNlYXJjaCIsIm9uQ2hhbmdlIiwidGV4dCIsIiRzZWxlY3RlZEl0ZW0iLCIkYXBwbHkiLCJmYWN0b3J5Iiwic3RhcnRUaW1lIiwiZW5kVGltZSIsInJlcXVlc3QiLCJyZXEiLCJsb2FkaW5nIiwicmVzcG9uc2UiLCJEYXRlIiwiZ2V0VGltZSIsIiRldmFsQXN5bmMiLCIkaHR0cCIsIiRxIiwiJHJvdXRlIiwiJHJvdXRlUGFyYW1zIiwiJGxvY2F0aW9uIiwiZHJvcGRvd25fbW9kZWwiLCJkcm9wZG93bl9yZXBlYXRfbW9kZWwiLCJkcm9wZG93bl9pdGVtcyIsImRyb3Bkb3duX2tleV92YWx1ZV9tb2RlbCIsImRyb3Bkb3duX2tleV92YWx1ZV9pdGVtcyIsIml0ZW0xIiwiaXRlbTQiLCJteUlucHV0VmFsMSIsIm15SW5wdXRWYWwyIiwibXlJbnB1dFZhbDMiLCJteUlucHV0VmFsNCIsInNlbGVjdFZhbCIsInBhcmVudE9wdGlvbnMiLCJpdGVtIiwic2VsZWN0IiwiaW5kZXgiLCJjdHJsIiwidGhpcyIsInNldHRpbmciLCJpbmxpbmUiLCJwbHVnaW5zIiwic2tpbiIsInRoZW1lIiwibWF4X2hlaWdodCIsInBhZ2VOYW1lIiwidXNlcklkIiwiZm9vIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBUUMsT0FBTyxTQUNkLFVBQ0EsY0FDQSwrQkFDQSxhQUNBLGVBQ0EsYUFDQSxlQUNFQyx5QkFFRiw2RUFLQUMsRUFBY0MsU0FBU0MsUUFBUUMsMEhBSy9CSCxFQUFBQyxTQUFBQyxRQUFBQyxJQUFBLE9BQUEsV0FFQ0MsRUFBWUMsS0FBQSxLQUNaQyxZQUFXLGlDQUNYQyxXQUFRLFdBQ1BDLFNBQ0NDLFVBQ0MsY0FDRSxTQUFNQyxHQUNELE1BQUlBLEdBQUFDLFVBQUFDLEtBQUEsU0FBQUMsNEpBWVRDLFVBQ0wsY0FDQSxTQUFXSixHQUNILE1BQUFBLEdBQUFLLFVBQUFILEtBQUEsU0FBQUMsR0FDUCxNQUFBQSxHQUFBRyw4QkFNRFgsS0FBQSxrREFFQUUsV0FBSyxlQUNMVSxnQkFBWSxJ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QyxXQUFBO0FDZkhsTCxRQUFRQyxPQUFPLGNBQUFTLFdBQUEsWUFDZCxTQUNBLFNBQ0EsZUFDQSxZQUNBLFdBQ0EsU0FBUWlHLEVBQUk2QyxFQUFBQyxFQUFBQyxFQUFBekksR0FDWjBGLEVBQVF3RSxTQUFJbEssRUFBQWtLLFNBQ1p4RSxFQUFLeUUsT0FBUzNCLEVBQVUyQixPQUN2QnpFLEVBQVEwRSxJQUFJLDBCQUVidEUsU0FBSy9FLElBQVM0SSxNQUNiN0QsUUFBUS9FLElBQUkySSwwQkFFWDVELFFBQUEvRSxJQUFBIiwiZmlsZSI6ImFsbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnbXlBcHAnLFtcclxuXHQnbmdSb3V0ZScsXHJcblx0J2FuZ3VsYXJUcml4JyxcclxuXHQnYW5ndWxhcmlmeS5zZW1hbnRpYy5kcm9wZG93bicsXHJcblx0J3VpLnRpbnltY2UnLFxyXG5cdCdteUFwcC5jb21tb24nLFxyXG5cdCdteUFwcC5tYWluJyxcclxuXHQnbXlBcHAudXNlcidcclxuXSkuY29uZmlnKGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJGh0dHBQcm92aWRlcil7XHJcbiAgICAvL0luaXRpYWxpemUgR2V0IFJlcXVlc3RcclxuXHRpZighJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmdldCl7XHJcblx0ICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0ID0ge307XHJcblx0fVxyXG5cclxuXHQvL0Rpc2FibGUgSUUgQWpheCBSZXF1ZXN0IENhY2hlXHJcblx0JGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1SZXF1ZXN0ZWQtV2l0aCddID0gJ1hNTEh0dHBSZXF1ZXN0JztcclxuXHQkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuZ2V0WydDYWNoZS1Db250cm9sJ10gPSAnbm8tY2FjaGUnO1xyXG5cdCRodHRwUHJvdmlkZXIuZGVmYXVsdHMuaGVhZGVycy5nZXRbJ1ByYWdtYSddID0gJ25vLWNhY2hlJztcclxuXHRcclxuXHQvL3JvdXRlIHNldHRpbmdcclxuXHQkcm91dGVQcm92aWRlclxyXG5cdC53aGVuKCcvJyx7XHJcblx0XHR0ZW1wbGF0ZVVybDondGVtcGxhdGUvdGVzdE5nUm91dGUtbWFpbi5odG1sJyxcclxuXHRcdGNvbnRyb2xsZXI6J21haW5DdHJsJyxcclxuXHRcdHJlc29sdmU6e1xyXG5cdFx0XHRtYWluRGF0YTpmdW5jdGlvbih0ZXN0U2VydmljZSl7XHJcblx0XHRcdFx0cmV0dXJuIHRlc3RTZXJ2aWNlLmdldE1haW4oKS50aGVuKGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdFx0fSkuY2F0Y2goZnVuY3Rpb24oZXJyKXtcclxuXHRcdFx0XHRcdHJldHVybiBlcnIuZGF0YTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG4vL1x0XHRcdHJlc3REYXRhOmZ1bmN0aW9uKHRlc3RTZXJ2aWNlKXtcclxuLy9cdFx0XHRcdHJldHVybiB0ZXN0U2VydmljZS5nZXRSZXN0KCkudGhlbihmdW5jdGlvbihyZXMpe1xyXG4vL1x0XHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcbi8vXHRcdFx0XHR9KS5jYXRjaChmdW5jdGlvbihlcnIpe1xyXG4vL1x0XHRcdFx0XHRyZXR1cm4gZXJyLmRhdGE7XHJcbi8vXHRcdFx0XHR9KTtcclxuLy9cdFx0XHR9XHJcblx0XHR9XHJcblx0fSlcclxuXHQud2hlbignL3VzZXIvOnVzZXJJZCcse1xyXG5cdFx0dGVtcGxhdGVVcmw6J3RlbXBsYXRlL3Rlc3ROZ1JvdXRlLXVzZXIuaHRtbCcsXHJcblx0XHRjb250cm9sbGVyOid1c2VyQ3RybCcsXHJcblx0XHRyZXNvbHZlOntcclxuXHRcdFx0dXNlckRhdGE6ZnVuY3Rpb24odGVzdFNlcnZpY2Upe1xyXG5cdFx0XHRcdHJldHVybiB0ZXN0U2VydmljZS5nZXRVc2VyKCkudGhlbihmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0cmV0dXJuIHJlcy5kYXRhO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0cmVsb2FkT25TZWFyY2g6ZmFsc2VcclxuXHR9KVxyXG5cdC53aGVuKCcvdGlueW1pY2UnLHtcclxuXHRcdHRlbXBsYXRlVXJsOid0ZW1wbGF0ZS90aW55bWljZS5odG1sJyxcclxuXHRcdGNvbnRyb2xsZXI6J3RpbnltaWNlQ3RybCcsXHJcblx0XHRyZWxvYWRPblNlYXJjaDpmYWxzZVxyXG5cdH0pXHJcblx0LndoZW4oJy9kcm9wZG93bicse1xyXG5cdFx0dGVtcGxhdGVVcmw6J3RlbXBsYXRlL2Ryb3Bkb3duLmh0bWwnLFxyXG5cdFx0Y29udHJvbGxlcjonVGVzdERyb3BEb3duQ3RybCcsXHJcblx0XHRyZWxvYWRPblNlYXJjaDpmYWxzZVxyXG5cdH0pXHJcblx0Lm90aGVyd2lzZSh7XHJcblx0XHRyZWRpcmVjdFRvOicvJ1xyXG5cdH0pO1xyXG5cdFxyXG5cdC8vaHRtbDUgbW9kZSBzZXR0aW5nXHJcblx0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKGZhbHNlKTtcclxuXHQkbG9jYXRpb25Qcm92aWRlci5oYXNoUHJlZml4KCcnKTtcclxuXHJcblx0Ly9JbnRlcmNlcHRvclxyXG5cdCRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2h0dHBJbnRlcmNlcHRvcicpO1xyXG5cdGNvbnNvbGUubG9nKCd0aGUgYW5ndWxhciBhcHAgaXMgc3RhcnQhJyk7XHJcbn0pXHJcbi5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwkdGVtcGxhdGVDYWNoZSl7XHJcblx0JHJvb3RTY29wZS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbihldmVudCwgbmV4dCwgY3VycmVudCkgeyAgXHJcbiAgICAgICAgaWYgKHR5cGVvZihjdXJyZW50KSAhPT0gJ3VuZGVmaW5lZCcpeyAgXHJcbiAgICAgICAgICAgICR0ZW1wbGF0ZUNhY2hlLnJlbW92ZShjdXJyZW50LnRlbXBsYXRlVXJsKTsgIFxyXG4gICAgICAgIH0gIFxyXG4gICAgfSk7XHJcbiAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlVXBkYXRlJyxmdW5jdGlvbihldmVudCwgbmV4dCwgY3VycmVudCl7XHJcbiAgICBcdGNvbnNvbGUubG9nKGV2ZW50KTtcclxuICAgIFx0Y29uc29sZS5sb2cobmV4dCk7XHJcbiAgICBcdGNvbnNvbGUubG9nKGN1cnJlbnQpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5hbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XHJcbiAgIGFuZ3VsYXIuYm9vdHN0cmFwKGRvY3VtZW50LFsnbXlBcHAnXSk7XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnbXlBcHAuY29tbW9uJyxbXSk7XHJcbmFuZ3VsYXIubW9kdWxlKCdteUFwcC5tYWluJyxbJ215QXBwLm1haW4udGlueW1pY2UnLCdteUFwcC5tYWluLmRyb3Bkb3duJ10pO1xyXG5hbmd1bGFyLm1vZHVsZSgnbXlBcHAubWFpbi50aW55bWljZScsWydteUFwcC5jb21tb24nLCd1aS50aW55bWNlJ10pO1xyXG5hbmd1bGFyLm1vZHVsZSgnbXlBcHAubWFpbi5kcm9wZG93bicsWydteUFwcC5jb21tb24nLCdhbmd1bGFyaWZ5LnNlbWFudGljLmRyb3Bkb3duJ10pO1xyXG5hbmd1bGFyLm1vZHVsZSgnbXlBcHAudXNlcicsWydteUFwcC5jb21tb24nXSk7IiwiLyoqXG4gKiBCaW5kcyBhIFRpbnlNQ0Ugd2lkZ2V0IHRvIDx0ZXh0YXJlYT4gZWxlbWVudHMuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCd1aS50aW55bWNlJywgW10pXG4gIC52YWx1ZSgndWlUaW55bWNlQ29uZmlnJywge30pXG4gIC5kaXJlY3RpdmUoJ3VpVGlueW1jZScsIFsnJHJvb3RTY29wZScsICckY29tcGlsZScsICckdGltZW91dCcsICckd2luZG93JywgJyRzY2UnLCAndWlUaW55bWNlQ29uZmlnJywgJ3VpVGlueW1jZVNlcnZpY2UnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkY29tcGlsZSwgJHRpbWVvdXQsICR3aW5kb3csICRzY2UsIHVpVGlueW1jZUNvbmZpZywgdWlUaW55bWNlU2VydmljZSkge1xuICAgIHVpVGlueW1jZUNvbmZpZyA9IHVpVGlueW1jZUNvbmZpZyB8fCB7fTtcblxuICAgIGlmICh1aVRpbnltY2VDb25maWcuYmFzZVVybCkge1xuICAgICAgdGlueW1jZS5iYXNlVVJMID0gdWlUaW55bWNlQ29uZmlnLmJhc2VVcmw7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlcXVpcmU6IFsnbmdNb2RlbCcsICdeP2Zvcm0nXSxcbiAgICAgIHByaW9yaXR5OiA1OTksXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmxzKSB7XG4gICAgICAgIGlmICghJHdpbmRvdy50aW55bWNlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG5nTW9kZWwgPSBjdHJsc1swXSxcbiAgICAgICAgICBmb3JtID0gY3RybHNbMV0gfHwgbnVsbDtcblxuICAgICAgICB2YXIgZXhwcmVzc2lvbiwgb3B0aW9ucyA9IHtcbiAgICAgICAgICBkZWJvdW5jZTogdHJ1ZVxuICAgICAgICB9LCB0aW55SW5zdGFuY2UsXG4gICAgICAgICAgdXBkYXRlVmlldyA9IGZ1bmN0aW9uKGVkaXRvcikge1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBlZGl0b3IuZ2V0Q29udGVudCh7Zm9ybWF0OiBvcHRpb25zLmZvcm1hdH0pLnRyaW0oKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSAkc2NlLnRydXN0QXNIdG1sKGNvbnRlbnQpO1xuXG4gICAgICAgICAgICBuZ01vZGVsLiRzZXRWaWV3VmFsdWUoY29udGVudCk7XG4gICAgICAgICAgICBpZiAoISRyb290U2NvcGUuJCRwaGFzZSkge1xuICAgICAgICAgICAgICBzY29wZS4kZGlnZXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiB0b2dnbGVEaXNhYmxlKGRpc2FibGVkKSB7XG4gICAgICAgICAgaWYgKGRpc2FibGVkKSB7XG4gICAgICAgICAgICBlbnN1cmVJbnN0YW5jZSgpO1xuXG4gICAgICAgICAgICBpZiAodGlueUluc3RhbmNlKSB7XG4gICAgICAgICAgICAgIHRpbnlJbnN0YW5jZS5nZXRCb2R5KCkuc2V0QXR0cmlidXRlKCdjb250ZW50ZWRpdGFibGUnLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVuc3VyZUluc3RhbmNlKCk7XG5cbiAgICAgICAgICAgIGlmICh0aW55SW5zdGFuY2UgJiYgIXRpbnlJbnN0YW5jZS5zZXR0aW5ncy5yZWFkb25seSAmJiB0aW55SW5zdGFuY2UuZ2V0RG9jKCkpIHtcbiAgICAgICAgICAgICAgdGlueUluc3RhbmNlLmdldEJvZHkoKS5zZXRBdHRyaWJ1dGUoJ2NvbnRlbnRlZGl0YWJsZScsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZldGNoIGEgdW5pcXVlIElEIGZyb20gdGhlIHNlcnZpY2VcbiAgICAgICAgdmFyIHVuaXF1ZUlkID0gdWlUaW55bWNlU2VydmljZS5nZXRVbmlxdWVJZCgpO1xuICAgICAgICBhdHRycy4kc2V0KCdpZCcsIHVuaXF1ZUlkKTtcblxuICAgICAgICBleHByZXNzaW9uID0ge307XG5cbiAgICAgICAgYW5ndWxhci5leHRlbmQoZXhwcmVzc2lvbiwgc2NvcGUuJGV2YWwoYXR0cnMudWlUaW55bWNlKSk7XG5cbiAgICAgICAgLy9EZWJvdW5jZSB1cGRhdGUgYW5kIHNhdmUgYWN0aW9uXG4gICAgICAgIHZhciBkZWJvdW5jZWRVcGRhdGUgPSAoZnVuY3Rpb24oZGVib3VuY2VkVXBkYXRlRGVsYXkpIHtcbiAgICAgICAgICB2YXIgZGVib3VuY2VkVXBkYXRlVGltZXI7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGVkKSB7XG5cdCAgICAgICAgJHRpbWVvdXQuY2FuY2VsKGRlYm91bmNlZFVwZGF0ZVRpbWVyKTtcblx0ICAgICAgICAgZGVib3VuY2VkVXBkYXRlVGltZXIgPSAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIChmdW5jdGlvbihlZCkge1xuICAgICAgICAgICAgICAgIGlmIChlZC5pc0RpcnR5KCkpIHtcbiAgICAgICAgICAgICAgICAgIGVkLnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgIHVwZGF0ZVZpZXcoZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSkoZWQpO1xuICAgICAgICAgICAgfSwgZGVib3VuY2VkVXBkYXRlRGVsYXkpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pKDQwMCk7XG5cbiAgICAgICAgdmFyIHNldHVwT3B0aW9ucyA9IHtcbiAgICAgICAgICAvLyBVcGRhdGUgbW9kZWwgd2hlbiBjYWxsaW5nIHNldENvbnRlbnRcbiAgICAgICAgICAvLyAoc3VjaCBhcyBmcm9tIHRoZSBzb3VyY2UgZWRpdG9yIHBvcHVwKVxuICAgICAgICAgIHNldHVwOiBmdW5jdGlvbihlZCkge1xuICAgICAgICAgICAgZWQub24oJ2luaXQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyKCk7XG4gICAgICAgICAgICAgIG5nTW9kZWwuJHNldFByaXN0aW5lKCk7XG4gICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0VW50b3VjaGVkKCk7XG4gICAgICAgICAgICAgIGlmIChmb3JtKSB7XG4gICAgICAgICAgICAgICAgZm9ybS4kc2V0UHJpc3RpbmUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBtb2RlbCB3aGVuOlxuICAgICAgICAgICAgLy8gLSBhIGJ1dHRvbiBoYXMgYmVlbiBjbGlja2VkIFtFeGVjQ29tbWFuZF1cbiAgICAgICAgICAgIC8vIC0gdGhlIGVkaXRvciBjb250ZW50IGhhcyBiZWVuIG1vZGlmaWVkIFtjaGFuZ2VdXG4gICAgICAgICAgICAvLyAtIHRoZSBub2RlIGhhcyBjaGFuZ2VkIFtOb2RlQ2hhbmdlXVxuICAgICAgICAgICAgLy8gLSBhbiBvYmplY3QgaGFzIGJlZW4gcmVzaXplZCAodGFibGUsIGltYWdlKSBbT2JqZWN0UmVzaXplZF1cbiAgICAgICAgICAgIGVkLm9uKCdFeGVjQ29tbWFuZCBjaGFuZ2UgTm9kZUNoYW5nZSBPYmplY3RSZXNpemVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGlmICghb3B0aW9ucy5kZWJvdW5jZSkge1xuICAgICAgICAgICAgICAgIGVkLnNhdmUoKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVWaWV3KGVkKTtcbiAgICAgICAgICAgICAgXHRyZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZGVib3VuY2VkVXBkYXRlKGVkKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBlZC5vbignYmx1cicsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBlbGVtZW50WzBdLmJsdXIoKTtcbiAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0VG91Y2hlZCgpO1xuICAgICAgICAgICAgICBpZiAoISRyb290U2NvcGUuJCRwaGFzZSkge1xuICAgICAgICAgICAgICAgIHNjb3BlLiRkaWdlc3QoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGVkLm9uKCdyZW1vdmUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAodWlUaW55bWNlQ29uZmlnLnNldHVwKSB7XG4gICAgICAgICAgICAgIHVpVGlueW1jZUNvbmZpZy5zZXR1cChlZCwge1xuICAgICAgICAgICAgICAgIHVwZGF0ZVZpZXc6IHVwZGF0ZVZpZXdcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChleHByZXNzaW9uLnNldHVwKSB7XG4gICAgICAgICAgICAgIGV4cHJlc3Npb24uc2V0dXAoZWQsIHtcbiAgICAgICAgICAgICAgICB1cGRhdGVWaWV3OiB1cGRhdGVWaWV3XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZm9ybWF0OiBleHByZXNzaW9uLmZvcm1hdCB8fCAnaHRtbCcsXG4gICAgICAgICAgc2VsZWN0b3I6ICcjJyArIGF0dHJzLmlkXG4gICAgICAgIH07XG4gICAgICAgIC8vIGV4dGVuZCBvcHRpb25zIHdpdGggaW5pdGlhbCB1aVRpbnltY2VDb25maWcgYW5kXG4gICAgICAgIC8vIG9wdGlvbnMgZnJvbSBkaXJlY3RpdmUgYXR0cmlidXRlIHZhbHVlXG4gICAgICAgIGFuZ3VsYXIuZXh0ZW5kKG9wdGlvbnMsIHVpVGlueW1jZUNvbmZpZywgZXhwcmVzc2lvbiwgc2V0dXBPcHRpb25zKTtcbiAgICAgICAgLy8gV3JhcHBlZCBpbiAkdGltZW91dCBkdWUgdG8gJHRpbnltY2U6cmVmcmVzaCBpbXBsZW1lbnRhdGlvbiwgcmVxdWlyZXNcbiAgICAgICAgLy8gZWxlbWVudCB0byBiZSBwcmVzZW50IGluIERPTSBiZWZvcmUgaW5zdGFudGlhdGluZyBlZGl0b3Igd2hlblxuICAgICAgICAvLyByZS1yZW5kZXJpbmcgZGlyZWN0aXZlXG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmIChvcHRpb25zLmJhc2VVUkwpe1xuICAgICAgICAgICAgdGlueW1jZS5iYXNlVVJMID0gb3B0aW9ucy5iYXNlVVJMO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgbWF5YmVJbml0UHJvbWlzZSA9IHRpbnltY2UuaW5pdChvcHRpb25zKTtcbiAgICAgICAgICBpZihtYXliZUluaXRQcm9taXNlICYmIHR5cGVvZiBtYXliZUluaXRQcm9taXNlLnRoZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIG1heWJlSW5pdFByb21pc2UudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdG9nZ2xlRGlzYWJsZShzY29wZS4kZXZhbChhdHRycy5uZ0Rpc2FibGVkKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG9nZ2xlRGlzYWJsZShzY29wZS4kZXZhbChhdHRycy5uZ0Rpc2FibGVkKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBuZ01vZGVsLiRmb3JtYXR0ZXJzLnVuc2hpZnQoZnVuY3Rpb24obW9kZWxWYWx1ZSkge1xuICAgICAgICAgIHJldHVybiBtb2RlbFZhbHVlID8gJHNjZS50cnVzdEFzSHRtbChtb2RlbFZhbHVlKSA6ICcnO1xuICAgICAgICB9KTtcblxuICAgICAgICBuZ01vZGVsLiRwYXJzZXJzLnVuc2hpZnQoZnVuY3Rpb24odmlld1ZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZpZXdWYWx1ZSA/ICRzY2UuZ2V0VHJ1c3RlZEh0bWwodmlld1ZhbHVlKSA6ICcnO1xuICAgICAgICB9KTtcblxuICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBlbnN1cmVJbnN0YW5jZSgpO1xuXG4gICAgICAgICAgdmFyIHZpZXdWYWx1ZSA9IG5nTW9kZWwuJHZpZXdWYWx1ZSA/XG4gICAgICAgICAgICAkc2NlLmdldFRydXN0ZWRIdG1sKG5nTW9kZWwuJHZpZXdWYWx1ZSkgOiAnJztcblxuICAgICAgICAgIC8vIGluc3RhbmNlLmdldERvYygpIGNoZWNrIGlzIGEgZ3VhcmQgYWdhaW5zdCBudWxsIHZhbHVlXG4gICAgICAgICAgLy8gd2hlbiBkZXN0cnVjdGlvbiAmIHJlY3JlYXRpb24gb2YgaW5zdGFuY2VzIGhhcHBlblxuICAgICAgICAgIGlmICh0aW55SW5zdGFuY2UgJiZcbiAgICAgICAgICAgIHRpbnlJbnN0YW5jZS5nZXREb2MoKVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgdGlueUluc3RhbmNlLnNldENvbnRlbnQodmlld1ZhbHVlKTtcbiAgICAgICAgICAgIC8vIFRyaWdnZXJpbmcgY2hhbmdlIGV2ZW50IGR1ZSB0byBUaW55TUNFIG5vdCBmaXJpbmcgZXZlbnQgJlxuICAgICAgICAgICAgLy8gYmVjb21pbmcgb3V0IG9mIHN5bmMgZm9yIGNoYW5nZSBjYWxsYmFja3NcbiAgICAgICAgICAgIHRpbnlJbnN0YW5jZS5maXJlKCdjaGFuZ2UnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgYXR0cnMuJG9ic2VydmUoJ2Rpc2FibGVkJywgdG9nZ2xlRGlzYWJsZSk7XG5cbiAgICAgICAgLy8gVGhpcyBibG9jayBpcyBiZWNhdXNlIG9mIFRpbnlNQ0Ugbm90IHBsYXlpbmcgd2VsbCB3aXRoIHJlbW92YWwgYW5kXG4gICAgICAgIC8vIHJlY3JlYXRpb24gb2YgaW5zdGFuY2VzLCByZXF1aXJpbmcgaW5zdGFuY2VzIHRvIGhhdmUgZGlmZmVyZW50XG4gICAgICAgIC8vIHNlbGVjdG9ycyBpbiBvcmRlciB0byByZW5kZXIgbmV3IGluc3RhbmNlcyBwcm9wZXJseVxuICAgICAgICB2YXIgdW5iaW5kRXZlbnRMaXN0ZW5lciA9IHNjb3BlLiRvbignJHRpbnltY2U6cmVmcmVzaCcsIGZ1bmN0aW9uKGUsIGlkKSB7XG4gICAgICAgICAgdmFyIGVpZCA9IGF0dHJzLmlkO1xuICAgICAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGlkKSB8fCBpZCA9PT0gZWlkKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50RWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCk7XG4gICAgICAgICAgICB2YXIgY2xvbmVkRWxlbWVudCA9IGVsZW1lbnQuY2xvbmUoKTtcbiAgICAgICAgICAgIGNsb25lZEVsZW1lbnQucmVtb3ZlQXR0cignaWQnKTtcbiAgICAgICAgICAgIGNsb25lZEVsZW1lbnQucmVtb3ZlQXR0cignc3R5bGUnKTtcbiAgICAgICAgICAgIGNsb25lZEVsZW1lbnQucmVtb3ZlQXR0cignYXJpYS1oaWRkZW4nKTtcbiAgICAgICAgICAgIHRpbnltY2UuZXhlY0NvbW1hbmQoJ21jZVJlbW92ZUVkaXRvcicsIGZhbHNlLCBlaWQpO1xuICAgICAgICAgICAgcGFyZW50RWxlbWVudC5hcHBlbmQoJGNvbXBpbGUoY2xvbmVkRWxlbWVudCkoc2NvcGUpKTtcbiAgICAgICAgICAgIHVuYmluZEV2ZW50TGlzdGVuZXIoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBlbnN1cmVJbnN0YW5jZSgpO1xuXG4gICAgICAgICAgaWYgKHRpbnlJbnN0YW5jZSkge1xuICAgICAgICAgICAgdGlueUluc3RhbmNlLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGlueUluc3RhbmNlID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGVuc3VyZUluc3RhbmNlKCkge1xuICAgICAgICAgIGlmICghdGlueUluc3RhbmNlKSB7XG4gICAgICAgICAgICB0aW55SW5zdGFuY2UgPSB0aW55bWNlLmdldChhdHRycy5pZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfV0pXG4gIC5zZXJ2aWNlKCd1aVRpbnltY2VTZXJ2aWNlJywgW1xuICAgIC8qKlxuICAgICAqIEEgc2VydmljZSBpcyB1c2VkIHRvIGNyZWF0ZSB1bmlxdWUgSUQncywgdGhpcyBwcmV2ZW50cyBkdXBsaWNhdGUgSUQncyBpZiB0aGVyZSBhcmUgbXVsdGlwbGUgZWRpdG9ycyBvbiBzY3JlZW4uXG4gICAgICovXG4gICAgZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgVUlUaW55bWNlU2VydmljZSA9IGZ1bmN0aW9uKCkge1xuICAgXHQgICAgdmFyIElEX0FUVFIgPSAndWktdGlueW1jZSc7XG4gICAgXHQvLyB1bmlxdWVJZCBrZWVwcyB0cmFjayBvZiB0aGUgbGF0ZXN0IGFzc2lnbmVkIElEXG4gICAgXHR2YXIgdW5pcXVlSWQgPSAwO1xuICAgICAgICAvLyBnZXRVbmlxdWVJZCByZXR1cm5zIGEgdW5pcXVlIElEXG4gICAgXHR2YXIgZ2V0VW5pcXVlSWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB1bmlxdWVJZCArKztcbiAgICAgICAgICByZXR1cm4gSURfQVRUUiArICctJyArIHVuaXF1ZUlkO1xuICAgICAgICB9O1xuICAgICAgICAvLyByZXR1cm4gdGhlIGZ1bmN0aW9uIGFzIGEgcHVibGljIG1ldGhvZCBvZiB0aGUgc2VydmljZVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICBcdGdldFVuaXF1ZUlkOiBnZXRVbmlxdWVJZFxuICAgICAgICB9O1xuICAgICAgfTtcbiAgICAgIC8vIHJldHVybiBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgc2VydmljZVxuICAgICAgcmV0dXJuIG5ldyBVSVRpbnltY2VTZXJ2aWNlKCk7XG4gICAgfVxuICBdKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdteUFwcC5jb21tb24nKVxyXG4uZGlyZWN0aXZlKCdteUlucHV0UGFyc2UnLGZ1bmN0aW9uKCl7XHJcblx0cmV0dXJue1xyXG5cdFx0cmVzdHJpY3Q6XCJFQVwiLFxyXG5cdFx0cHJpb3JpdHk6LTEsXHJcblx0XHRyZXF1aXJlOic/bmdNb2RlbCcsXHJcblx0XHRsaW5rOmZ1bmN0aW9uKCRzY29wZSwgJGVsZW0sICRhdHRycywgbmdNb2RlbEN0cmwpe1xyXG5cdFx0XHRpZighbmdNb2RlbEN0cmwpIHJldHVybjtcclxuXHRcdFx0Y29uc29sZS5sb2coJ215SW5wdXRQYXJzZScpO1xyXG5cdFx0XHRuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKXtcclxuLy9cdFx0XHRcdHZhciBWQUxJRF9SRUdFWFAgPSAvXlxcdyskLyxcclxuXHRcdFx0XHR2YXIgVkFMSURfUkVHRVhQID0gL15cXGQrXFwuP1xcZHswLDJ9JC8sXHJcblx0XHRcdCBcdGlzVmFsaWQgPSBWQUxJRF9SRUdFWFAudGVzdCh2YWx1ZSksXHJcblx0XHRcdCAgICBsYXN0VmFsID0gdmFsdWUuc3Vic3RyaW5nKDAsdmFsdWUubGVuZ3RoLTEpO1xyXG5cdFx0XHQgICAgXHJcblx0XHRcdFx0aWYoaXNWYWxpZCl7XHJcblx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XHJcblx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHRuZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKGxhc3RWYWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcclxuXHRcdFx0XHRcdHJldHVybiBsYXN0VmFsO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fVxyXG59KVxyXG4uZGlyZWN0aXZlKCdjb21wYW55RW1haWxWYWxpZGF0b3InLGZ1bmN0aW9uKCl7XHJcbi8qY2hhbmdlIGVtYWlsIHZhbGlkYXRvciBydWxlczpVcCB0byAyNTQgY2hhcmFjdGVyIGJlZm9yZSAnQCcqL1xyXG5cdHZhciBFTUFJTF9SRUdFWFAgPSAvXig/PS57MSwyNTR9JCkoPz0uezEsMjU0fUApWy0hIyQlJicqKy8wLTk9P0EtWl5fYGEtent8fX5dKyhcXC5bLSEjJCUmJyorLzAtOT0/QS1aXl9gYS16e3x9fl0rKSpAW0EtWmEtejAtOV0oW0EtWmEtejAtOS1dezAsNjF9W0EtWmEtejAtOV0pPyhcXC5bQS1aYS16MC05XShbQS1aYS16MC05LV17MCw2MX1bQS1aYS16MC05XSk/KSokLztcclxuXHRyZXR1cm57XHJcblx0XHRyZXN0cmljdDpcIkVBXCIsXHJcblx0XHRwcmlvcml0eTotMSxcclxuXHRcdHJlcXVpcmU6Jz9uZ01vZGVsJyxcclxuXHRcdGxpbms6ZnVuY3Rpb24oJHNjb3BlLCRlbGVtLCRhdHRycyxuZ01vZGVsQ3RybCl7XHJcblx0XHRcdGlmKG5nTW9kZWxDdHJsICYmIG5nTW9kZWxDdHJsLiR2YWxpZGF0b3JzLmVtYWlsKXtcclxuXHRcdFx0XHRuZ01vZGVsQ3RybC4kdmFsaWRhdG9ycy5lbWFpbCA9IGZ1bmN0aW9uKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSkge1xyXG5cdFx0ICAgIFx0XHR2YXIgdmFsdWUgPSBtb2RlbFZhbHVlIHx8IHZpZXdWYWx1ZTtcclxuXHRcdCAgICBcdFx0cmV0dXJuIG5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKSB8fCBFTUFJTF9SRUdFWFAudGVzdCh2YWx1ZSk7XHJcblx0XHQgXHRcdCB9O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59KVxyXG4uZGlyZWN0aXZlKCdyZXRhaW5EZWNpbWFsJyxmdW5jdGlvbigpe1xyXG5cdHZhciBST1VORFVQXzBfUkVHRVhQID0gL15cXGQrJC8sXHRcclxuXHRcdFJPVU5EVVBfMV9SRUdFWFAgPSAvXlxcZCsoXFwuKT9cXGR7MCwxfSQvLFxyXG5cdFx0Uk9VTkRVUF8yX1JFR0VYUCA9IC9eXFxkKyhcXC4pP1xcZHswLDJ9JC8sXHJcblx0XHRyZXRhaW5Db25maWcgPSB7XHJcblx0XHRcdHJlc3RyaWN0OlwiQVwiLFxyXG5cdFx0XHRyZXF1aXJlOic/bmdNb2RlbCcsXHJcblx0XHRcdGxpbms6ZnVuY3Rpb24oJHNjb3BlLCRlbGVtLCRhdHRycyxuZ01vZGVsQ3RybCl7XHJcblx0XHRcdFx0bmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSl7XHJcblx0XHRcdFx0XHR2YXIgcmV0YWluRGVjaW1hbCA9ICRhdHRycy5yZXRhaW5EZWNpbWFsLFxyXG5cdFx0XHRcdFx0XHRsYXN0VmFsID0gdmFsdWUuc3Vic3RyaW5nKDAsdmFsdWUubGVuZ3RoLTEpLFxyXG5cdFx0XHRcdFx0XHRsYXN0Q2hhciA9IHZhbHVlLmNoYXJBdCh2YWx1ZS5sZW5ndGgtMSksXHJcblx0XHRcdFx0XHRcdGlzVmFsaWQsc3RyO1xyXG5cdFx0XHRcdFx0c3dpdGNoKHJldGFpbkRlY2ltYWwpe1xyXG5cdFx0XHRcdFx0XHRjYXNlIFwiMVwiOlxyXG5cdFx0XHRcdFx0XHRcdGlzVmFsaWQgPSBST1VORFVQXzFfUkVHRVhQLnRlc3QodmFsdWUpO1xyXG5cdFx0XHRcdFx0XHRcdHN0ciA9ICcuMCc7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdGNhc2UgXCIyXCI6XHJcblx0XHRcdFx0XHRcdFx0aXNWYWxpZCA9IFJPVU5EVVBfMl9SRUdFWFAudGVzdCh2YWx1ZSk7XHJcblx0XHRcdFx0XHRcdFx0c3RyID0gJy4wMCc7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdGRlZmF1bHQ6XHJcblx0XHRcdFx0XHRcdFx0aXNWYWxpZCA9IFJPVU5EVVBfMF9SRUdFWFAudGVzdCh2YWx1ZSk7XHJcblx0XHRcdFx0XHRcdFx0c3RyID0gJyc7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHRcdFx0ICAgIFxyXG5cdFx0XHRcdFx0aWYoaXNWYWxpZCl7XHJcblx0XHRcdFx0XHRcdGlmKGxhc3RDaGFyID09ICcuJyl7XHJcblx0XHRcdFx0XHRcdFx0bmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZShsYXN0VmFsK3N0cik7XHJcblx0ICAgICAgICAgICAgICAgICAgICBcdG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbGFzdFZhbCtzdHI7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlO1xyXG5cdFx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHRcdG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUobGFzdFZhbCk7XHJcblx0ICAgICAgICAgICAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XHJcblx0XHRcdFx0XHRcdHJldHVybiBsYXN0VmFsO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdHJldHVybiByZXRhaW5Db25maWc7XHJcbn0pXHJcbi5kaXJlY3RpdmUoJ3NlYXJjaFNlbGVjdCcsZnVuY3Rpb24oJHNjZSl7XHJcblx0cmV0dXJue1xyXG5cdFx0cmVzdHJpY3Q6XCJFQVwiLFxyXG5cdFx0cmVwbGFjZTp0cnVlLFxyXG5cdFx0dHJhbnNjbHVkZTogdHJ1ZSxcclxuXHRcdHJlcXVpcmU6Jz9uZ01vZGVsJyxcclxuXHRcdHNjb3BlOntcclxuXHRcdFx0b3B0aW9uczonPScsXHJcblx0XHRcdG5hbWU6J0AnXHJcblx0XHR9LFxyXG5cdFx0dGVtcGxhdGU6XHRcclxuXHRcdFx0JzxkaXYgY2xhc3M9XCJ1aSBmbHVpZCBzZWFyY2ggc2VsZWN0aW9uIGRyb3Bkb3duIHVwd2FyZFwiPlxcXHJcblx0XHRcdFx0PGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwie3tuYW1lfX1cIiBuZy1tb2RlbD1cInNlbGVjdGVkVmFsdWVcIj5cXFxyXG5cdFx0XHRcdDxpIGNsYXNzPVwiZHJvcGRvd24gaWNvblwiPjwvaT5cXFxyXG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJkZWZhdWx0IHRleHRcIiBuZy1iaW5kPVwic2VsZWN0ZWRWYWx1ZVwiPjwvZGl2PlxcXHJcblx0XHRcdCAgXHQ8ZGl2IGNsYXNzPVwibWVudSB0cmFuc2l0aW9uIGhpZGRlblwiPlxcXHJcblx0XHRcdCAgICBcdDxkaXYgY2xhc3M9XCJpdGVtXCIgZGF0YS1pbmRleD1cInt7b3B0aW9uLmluZGV4fX1cIiBkYXRhLXZhbHVlPVwie3tvcHRpb24uaW5kZXh9fVwiIG5nLXJlcGVhdCA9IFwib3B0aW9uIGluIG9wdGlvbnNcIiBuZy1iaW5kPVwib3B0aW9uLml0ZW1cIj48L2Rpdj5cXFxyXG5cdFx0XHQgIFx0PC9kaXY+XFxcclxuXHRcdFx0PC9kaXY+JyxcclxuXHRcdGxpbms6ZnVuY3Rpb24oJHNjb3BlLCRlbGVtLCRhdHRycyxuZ01vZGVsKXtcclxuXHRcdFx0JGVsZW0uZHJvcGRvd24oe1xyXG5cdFx0XHRcdGZ1bGxUZXh0U2VhcmNoOnRydWUsXHJcblx0XHRcdFx0b25DaGFuZ2U6IGZ1bmN0aW9uKHZhbHVlLCB0ZXh0LCAkc2VsZWN0ZWRJdGVtKSB7XHJcblx0XHRcdFx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdG5nTW9kZWwuJHNldFZpZXdWYWx1ZSh2YWx1ZSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0ICAgIH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdG5nTW9kZWwuJHJlbmRlciA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ2l0IGlzICRyZW5kZXInKTtcclxuXHRcdFx0XHQkZWxlbS5kcm9wZG93bignc2V0IHNlbGVjdGVkJyxcIjNcIik7XHJcblx0XHRcdH07XHJcbi8vXHRcdFx0JGVsZW0uZHJvcGRvd24oJ3NldCBzZWxlY3RlZCcsXCIzXCIpO1xyXG5cdFx0XHQkYXR0cnMuJG9ic2VydmUoJ25nTW9kZWwnLGZ1bmN0aW9uKHZhbCl7XHJcblx0XHRcdFx0Y29uc29sZS5sb2codmFsKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnbXlBcHAuY29tbW9uJylcclxuLmZhY3RvcnkoJ2h0dHBJbnRlcmNlcHRvcicsZnVuY3Rpb24oJHNjZSwkcm9vdFNjb3BlLCR0aW1lb3V0KXtcclxuXHR2YXIgc3RhcnRUaW1lLGVuZFRpbWU7XHJcblx0cmV0dXJue1xyXG5cdFx0J3JlcXVlc3QnOmZ1bmN0aW9uKHJlcSl7XHJcblx0XHRcdHN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG5cdFx0XHQkcm9vdFNjb3BlLmxvYWRpbmcgPSB0cnVlO1xyXG5cdFx0XHRyZXR1cm4gcmVxO1xyXG5cdFx0fSxcclxuXHRcdCdyZXNwb25zZSc6ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0ZW5kVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG5cdFx0XHQkcm9vdFNjb3BlLiRldmFsQXN5bmMoZnVuY3Rpb24oKXtcclxuXHRcdFx0XHR2YXIgbG9hZGluZ1RpbWUgPSBlbmRUaW1lLXN0YXJ0VGltZTtcclxuXHRcdFx0XHRpZihsb2FkaW5nVGltZSA+IDUwMCl7XHJcblx0XHRcdFx0XHQkcm9vdFNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdCR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHRcdCRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0fSw1MDApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdHJldHVybiByZXM7XHJcblx0XHR9XHJcblx0fVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnbXlBcHAuY29tbW9uJylcclxuLmZhY3RvcnkoJ3Rlc3RTZXJ2aWNlJyxmdW5jdGlvbigkaHR0cCwkcSl7XHJcblx0cmV0dXJue1xyXG5cdFx0Z2V0TWFpbjpmdW5jdGlvbigpe1xyXG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCdtb2NrL3Rlc3ROZ1JvdXRlLW1haW4uanNvbicpO1xyXG5cdFx0fSxcclxuXHRcdGdldFVzZXI6ZnVuY3Rpb24oKXtcclxuXHRcdFx0cmV0dXJuICRodHRwLmdldCgnbW9jay90ZXN0TmdSb3V0ZS11c2VyLmpzb24nKTtcclxuXHRcdH0sXHJcblx0XHRnZXRSZXN0OmZ1bmN0aW9uKCl7XHJcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9yZXN0YXBpL2xvZ2luJyk7XHJcblx0XHR9XHJcblx0fVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnbXlBcHAubWFpbi5kcm9wZG93bicpXHJcbi5jb250cm9sbGVyKCdUZXN0RHJvcERvd25DdHJsJyxmdW5jdGlvbigkc2NvcGUsICRyb3V0ZSwgJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24sICRzY2Upe1xyXG4gICAgJHNjb3BlLmRyb3Bkb3duX21vZGVsID0gJ2l0ZW0zJztcclxuXHJcbiAgICAkc2NvcGUuZHJvcGRvd25fcmVwZWF0X21vZGVsID0gJ2l0ZW0xJztcclxuICAgICRzY29wZS5kcm9wZG93bl9pdGVtcyA9IFtcclxuICAgICAgJ2l0ZW0xJyxcclxuICAgICAgJ2l0ZW0yJyxcclxuICAgICAgJ2l0ZW0zJyxcclxuICAgICAgJ2l0ZW00J1xyXG4gICAgXTtcclxuXHJcbiAgICAkc2NvcGUuZHJvcGRvd25fa2V5X3ZhbHVlX21vZGVsID0gJyc7XHJcbiAgICAkc2NvcGUuZHJvcGRvd25fa2V5X3ZhbHVlX2l0ZW1zID0ge1xyXG4gICAgICAnaXRlbTEnOiAnQ29vbCBpdGVtIDEnLFxyXG4gICAgICAnaXRlbTInOiAnQ29vbCBpdGVtIDInLFxyXG4gICAgICAnaXRlbTMnOiAnQ29vbCBpdGVtIDMnLFxyXG4gICAgICAnaXRlbTQnOiAnQ29vbCBpdGVtIDQnXHJcbiAgICB9O1xyXG59KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ215QXBwLm1haW4nKVxyXG4uY29udHJvbGxlcignbWFpbkN0cmwnLGZ1bmN0aW9uKCRzY29wZSwgJHJvdXRlLCAkcm91dGVQYXJhbXMsICRsb2NhdGlvbiwgbWFpbkRhdGEsICRwYXJzZSl7XHJcblx0JHNjb3BlLnBhZ2VOYW1lID0gbWFpbkRhdGEucGFnZU5hbWU7XHJcblx0JHNjb3BlLm15SW5wdXRWYWwxID0gXCIxMTFcIjtcclxuXHQkc2NvcGUubXlJbnB1dFZhbDIgPSBcIlwiO1xyXG5cdCRzY29wZS5teUlucHV0VmFsMyA9IFwiXCI7XHJcblx0JHNjb3BlLm15SW5wdXRWYWw0ID0gXCJcIjtcclxuLy9cdCRzY29wZS5kYXRlID0gcmVzdERhdGEuZGF0YS5kYXRlO1xyXG4vL1x0Y29uc29sZS5kZWJ1ZyhyZXN0RGF0YSk7XHJcblx0JHNjb3BlLnNlbGVjdFZhbCA9IFwiXCI7XHJcblx0JHNjb3BlLnBhcmVudE9wdGlvbnMgPSBbXHJcblx0XHR7aXRlbTpcIkFyYWJpYyBDaGluZXNlXCIsc2VsZWN0OnRydWUsaW5kZXg6MX0sXHJcblx0XHR7aXRlbTpcIkNoaW5lc2UgXCIsc2VsZWN0OmZhbHNlLGluZGV4OjJ9LFxyXG5cdFx0e2l0ZW06XCJEdXRjaFwiLHNlbGVjdDpmYWxzZSxpbmRleDozfSxcclxuXHRcdHtpdGVtOlwiRW5nbGlzaFwiLHNlbGVjdDpmYWxzZSxpbmRleDo0fSxcclxuXHRcdHtpdGVtOlwiRnJlbmNoXCIsc2VsZWN0OmZhbHNlLGluZGV4OjV9LFxyXG5cdFx0e2l0ZW06XCJHZXJtYW5cIixzZWxlY3Q6ZmFsc2UsaW5kZXg6Nn0sXHJcblx0XHR7aXRlbTpcIkdyZWVrXCIsc2VsZWN0OmZhbHNlLGluZGV4Ojd9LFxyXG5cdFx0e2l0ZW06XCJIdW5nYXJpYW5cIixzZWxlY3Q6ZmFsc2UsaW5kZXg6OH0sXHJcblx0XHR7aXRlbTpcIkl0YWxpYW5cIixzZWxlY3Q6ZmFsc2UsaW5kZXg6OX0sXHJcblx0XHR7aXRlbTpcIkphcGFuZXNlXCIsc2VsZWN0OmZhbHNlLGluZGV4OjEwfSxcclxuXHRcdHtpdGVtOlwiS29yZWFuXCIsc2VsZWN0OmZhbHNlLGluZGV4OjExfSxcclxuXHRcdHtpdGVtOlwiTGl0aHVhbmlhblwiLHNlbGVjdDpmYWxzZSxpbmRleDoxMn0sXHJcblx0XHR7aXRlbTpcIlBlcnNpYW5cIixzZWxlY3Q6ZmFsc2UsaW5kZXg6MTN9LFxyXG5cdFx0e2l0ZW06XCJQb2xpc2hcIixzZWxlY3Q6ZmFsc2UsaW5kZXg6MTR9LFxyXG5cdFx0e2l0ZW06XCJQb3J0dWd1ZXNlXCIsc2VsZWN0OmZhbHNlLGluZGV4OjE1fSxcclxuXHRcdHtpdGVtOlwiUnVzc2lhblwiLHNlbGVjdDpmYWxzZSxpbmRleDoxNn0sXHJcblx0XHR7aXRlbTpcIlNwYW5pc2hcIixzZWxlY3Q6ZmFsc2UsaW5kZXg6MTd9LFxyXG5cdFx0e2l0ZW06XCJTd2VkaXNoXCIsc2VsZWN0OmZhbHNlLGluZGV4OjE4fSxcclxuXHRcdHtpdGVtOlwiVHVya2lzaFwiLHNlbGVjdDpmYWxzZSxpbmRleDoxOX0sXHJcblx0XHR7aXRlbTpcIlZpZXRuYW1lc2VcIixzZWxlY3Q6ZmFsc2UsaW5kZXg6MjB9XHJcblx0XTtcclxuXHQkc2NvcGUudXBkYXRlVmFsID0gZnVuY3Rpb24oKXtcclxuXHRcdHZhciB0ZXh0ID0gXCInaXQgaXMgbXkgdGVzdCF0aGUgcmVzdWx0IGlzOicgKyBteUlucHV0VmFsMVwiO1xyXG5cdFx0dmFyIGlucHV0RnVjID0gJHBhcnNlKHRleHQpO1xyXG5cdFx0JHNjb3BlLm15SW5wdXRWYWxSZXMgPSBpbnB1dEZ1Yygkc2NvcGUpO1xyXG5cdH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ215QXBwLm1haW4udGlueW1pY2UnKVxyXG4uY29udHJvbGxlcigndGlueW1pY2VDdHJsJyxmdW5jdGlvbigkc2NvcGUsICRyb3V0ZSwgJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24sICRzY2Upe1xyXG4gICB2YXIgY3RybCA9IHRoaXM7XHJcblx0JHNjb3BlLnNldHRpbmcgPSB7XHJcblx0XHRpbmxpbmU6IGZhbHNlLFxyXG5cdCAgXHRwbHVnaW5zOiBcImFkdmxpc3QgYXV0b2xpbmsgbGlzdHMgbGluayBpbWFnZSBjaGFybWFwIHByaW50IHByZXZpZXcgYW5jaG9yXCIsXHJcbiAgIFx0XHRyZWFkb25seSA6ICRzY29wZS5vcGVyYXRlID09PSAndmlldycgPyB0cnVlIDogZmFsc2UsXHJcblx0ICAgIHNraW46ICdsaWdodGdyYXknLFxyXG4gICAgXHR0aGVtZSA6ICdtb2Rlcm4nLFxyXG4gICAgXHRtaW5faGVpZ2h0OiAyMDAsXHJcbiAgICBcdG1heF9oZWlnaHQ6IDUwMFxyXG5cdH07XHJcbiAgICB0aGlzLnVwZGF0ZUh0bWwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgY3RybC50aW55bWNlSHRtbCA9ICRzY2UudHJ1c3RBc0h0bWwoY3RybC50aW55bWNlKTtcclxuICAgIH07XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdteUFwcC51c2VyJylcclxuLmNvbnRyb2xsZXIoJ3VzZXJDdHJsJyxmdW5jdGlvbigkc2NvcGUsICRyb3V0ZSwgJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24sIHVzZXJEYXRhKXtcclxuXHQkc2NvcGUucGFnZU5hbWUgPSB1c2VyRGF0YS5wYWdlTmFtZTtcclxuXHQkc2NvcGUudXNlcklkID0gJHJvdXRlUGFyYW1zLnVzZXJJZDtcclxuXHQkc2NvcGUuZm9vID0gXCJwbGVhc2UgaW5wdXQhXCI7XHJcblx0dmFyIGN0cmwgPSB0aGlzO1xyXG5cdGNvbnNvbGUubG9nKHRoaXMpO1xyXG5cdGNvbnNvbGUubG9nKGN0cmwpO1xyXG5cdHRoaXMudXBkYXRlID0gZnVuY3Rpb24oKXtcclxuXHRcdGNvbnNvbGUubG9nKCd0aGlzIHVwZGF0ZScpO1xyXG5cdH07XHJcblx0dGhpcy5kZWxldGUgPSBmdW5jdGlvbigpe1xyXG5cdFx0Y29uc29sZS5sb2coJ3RoaXMgdXBkYXRlJyk7XHJcblx0fTtcclxufSk7Il19
